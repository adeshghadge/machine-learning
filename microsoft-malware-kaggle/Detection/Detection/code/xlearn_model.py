import xlearn as xl

# Training task
ffm_model = xl.create_ffm()                # Use field-aware factorization machine (ffm)
ffm_model.setTrain("train_ffm.txt")    # Path of training data

# param:
#  0. task: binary classification
#  1. learning rate : 0.2
#  2. regular lambda : 0.002
param = {'task':'binary', 'lr':0.01, 'lambda':0.002, 'epoch': 30, 'nthread': 4, 'metric': 'auc'}

# Train model
ffm_model.fit(param, "./model.out")
